<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>포켓미니 아이템 전체 목록</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
  .category-tabs {
    display: block;
    white-space: nowrap;
    overflow-x: auto;
    max-width: 100vw;
    margin-bottom: 1.1em;
  }
  .cat-btn {
    display: inline-flex;
    min-width: 44px;
    flex: none;
    justify-content: center;
    background: none; border: none; outline: none;
    padding: 0.22em 0.22em 0.11em 0.22em;
    flex-direction: column; align-items: center;
    font-size: 0.82em; color: #555; cursor: pointer;
    border-radius: 1em;
    transition: color 0.15s, background 0.18s;
    margin-right: 0.08em;
  }
  .cat-btn.selected {
    color: #fd47b4; background: #fff1fb;
  }
  .cat-btn img {
    width: 33px; height: 33px; margin-bottom: 0.12em; pointer-events: none;
    filter: drop-shadow(0 0 2px #fff8);
  }
  .category-tabs span {
    font-size: 0.89em; margin-top: -0.13em;
  }
    body { background: #f5f6fa; font-family: 'Noto Sans KR', sans-serif; margin:0; }
    .top-bar {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 0.4em;
      padding: 1.2em 1.2em 0.5em;
      background: #fff;
      border-bottom: 1px solid #f1f3f9;
    }
    .top-bar-filters {
      display: flex;
      gap: 0.8em;
      width: 100%;
      margin-top: 0.2em;
      align-items: center;
    }
    .top-bar input[type=password], .top-bar input[type=text] {padding:0.6em; border-radius:0.7em; border:1px solid #cbd3da; font-size:1em;}
    .top-bar select {padding:0.5em 0.8em; border-radius:0.7em; border:1.2px solid #dbe1ea; background:#f4f5fb;}
    .top-bar button {padding:0.65em 1.2em; border-radius:0.8em; background:#a6aefc; color:#1a237e; border:none; font-weight:bold; cursor:pointer;}
    .top-bar .admin-btn {background:#222; color:#fff;}
    .main {max-width:1120px; margin:2.5em auto 0; padding:0 1em;}
    .card-list {display:flex; flex-wrap:wrap; gap:1.5em; margin-top:2.3em;}
    .item-card { background:#fff; border-radius:1.1em; box-shadow:0 2px 10px #0001; padding:0.6em; width:122px; min-height:164px; display:flex; flex-direction:column; align-items:center; position:relative;}
    .item-card .item-img {
      width: 100%;
      aspect-ratio: 5/4;
      object-fit: cover;
      border-radius: 0.5em;
      margin-bottom: 0.4em;
      background: #eee;
      display: block;
      box-shadow:0 0 4px #0001;
    }
    .item-card .badge { display:inline-block; font-weight:bold; font-size:0.98em; padding:0.19em 1.1em; border-radius:0.9em; margin-bottom:0.25em;}
    .badge-sr { background:#fff6c1; color:#be9800;}
    .badge-r { background:#ececec; color:#7d7d7d;}
    .badge-n { background:#c8e6ff; color:#1976d2;}
    .item-card .item-title { font-size:0.98em; font-weight:400; margin-bottom:0.13em; text-align:center;}
    .item-card .item-qty { color:#555; font-size:0.98em; margin-bottom:0.5em;}
    .item-card .card-btns {display:flex; gap:0.5em;}
    .item-card .edit-btn, .item-card .del-btn { border:none; background:#ececec; border-radius:0.7em; padding:0.3em 0.95em; font-size:0.97em; cursor:pointer;}
    .item-card .edit-btn {background:#a6f1b7; color:#18713a;}
    .item-card .del-btn {background:#ffcccc; color:#ae2323;}
    .admin-bar {display:none; justify-content:space-between; align-items:center; background:#fafbff; border-radius:1em; margin:1.5em 0 0.8em; padding:1.1em 2.5em 1em;}
    .admin-bar.active {display:flex;}
    .admin-bar .filter-group {display:flex; gap:0.8em;}
    .admin-bar .admin-add-btn {background:#ffe066; color:#765c01;}
    /* 팝업 */
    .popup-bg {display:none;position:fixed;z-index:10;left:0;top:0;width:100vw;height:100vh;background:#2227;}
    .popup-box {display:none;position:fixed;z-index:11;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border-radius:1.3em;box-shadow:0 4px 24px #0004;padding:2.2em 2em 1.2em;min-width:320px;max-width:90vw;}
    .popup-box label{font-weight:bold;display:block;margin-top:1em;}
    .popup-box input, .popup-box select {width:100%;font-size:1em;margin:0.45em 0 0.2em;padding:0.7em 0.9em;border-radius:0.8em;border:1.1px solid #cbd3da;box-sizing:border-box;}
    .popup-box .popup-btns{margin-top:1.5em;text-align:center;}
    .popup-box button{padding:0.6em 1.3em;border-radius:0.8em;border:none;font-weight:bold;cursor:pointer;}
    .popup-box .popup-save{background:#a6f1b7;color:#18713a;margin-right:0.8em;}
    .popup-box .popup-cancel{background:#ececec;color:#7d7d7d;}
    /* 모바일 2열 */
    @media (max-width: 640px) {
      .main {padding:0;}
      .card-list {gap:0.4em; flex-wrap: wrap;}
      .item-card {width:28vw; min-width:70px;}
      .admin-bar {padding:1.2em 1em;}
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <!-- 상단 로그인/필터 -->
  <div class="top-bar">
    <div style="display:flex;align-items:center;gap:0.9em;">
      <span style="font-weight:bold;color:#343;">32f6c7 중복글</span>
      <input id="admin-pw" type="password" placeholder="비밀번호" style="width:110px;">
      <button id="admin-login-btn" class="admin-btn">관리자모드</button>
    </div>
    <div class="top-bar-filters">
      <input id="search-keyword" type="text" placeholder="템 이름 검색" style="min-width:220px;flex:2;">
      <select id="filter-year"><option value="">연도</option></select>
      <select id="filter-theme01"><option value="">테마분류</option></select>
    </div>
    <!-- ↓↓↓ 카테고리 탭을 top-bar-filters 바로 아래로 이동!! ↓↓↓ -->
    <div class="category-tabs">
      <button class="cat-btn selected" data-cat="">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_all.png" alt="전체">
      </button>
      <button class="cat-btn" data-cat="헤어">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_hair.png" alt="헤어">
      </button>
      <button class="cat-btn" data-cat="상하의">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_clothes.png" alt="상하의">
      </button>
      <button class="cat-btn" data-cat="남옷">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_boy.png" alt="남옷">
      </button>
      <button class="cat-btn" data-cat="여옷">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_girl.png" alt="여옷">
      </button>
      <button class="cat-btn" data-cat="겉옷">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_outer.png" alt="겉옷">
      </button>
      <button class="cat-btn" data-cat="신발">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_shoes.png" alt="신발">
      </button>
      <button class="cat-btn" data-cat="모자">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_hat.png" alt="모자">
      </button>
      <button class="cat-btn" data-cat="리본">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_ribbon.png" alt="리본">
      </button>
      <button class="cat-btn" data-cat="안경">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_glasses.png" alt="안경">
      </button>
      <button class="cat-btn" data-cat="왼손">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_left.png" alt="왼손">
      </button>
      <button class="cat-btn" data-cat="오른손">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_right.png" alt="오른손">
      </button>
      <button class="cat-btn" data-cat="몸통">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_body.png" alt="몸통">
      </button>
      <button class="cat-btn" data-cat="아우라">
        <img src="https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_aura.png" alt="아우라">
      </button>
    </div>
  </div>
  <!-- 관리자만: 관리바 -->
  <div class="main">
    <div class="admin-bar" id="admin-bar">
      <div class="filter-group">
        <input id="admin-search" type="text" placeholder="템 이름 검색" style="min-width:120px;">
        <select id="admin-filter-year"><option value="">연도</option></select>
        <select id="admin-filter-theme01"><option value="">테마분류</option></select>
      </div>
      <button class="admin-add-btn" id="admin-add-btn">아이템 추가하기</button>
    </div>
    <div class="card-list" id="card-list"></div>
  </div>
  <!-- 팝업 (추가/수정) -->
  <div class="popup-bg" id="popup-bg"></div>
  <div class="popup-box" id="popup-box">
    <form id="popup-form" autocomplete="off">
      <h2 id="popup-title" style="margin:0 0 0.6em;font-size:1.12em;"></h2>
      <label>템 이름<input id="form-title" required maxlength="30"></label>
      <label>수량<input id="form-qty" type="number" min="0" required></label>
      <label>등급
        <select id="form-grade" required>
          <option value="">등급 선택</option>
          <option value="SR">SR</option>
          <option value="R">R</option>
          <option value="N">N</option>
        </select>
      </label>
      <label>썸네일 첨부<input id="form-img" type="file" accept="image/*"></label>
      <label>출시일<input id="form-date" type="date" required></label>
      <label>테마 분류<input id="form-theme01" required maxlength="20"></label>
      <label>카테고리
        <select id="form-category" required>
          <option value="">카테고리 선택</option>
          <option>헤어</option>
          <option>상하의</option>
          <option>남옷</option>
          <option>여옷</option>
          <option>겉옷</option>
          <option>신발</option>
          <option>모자</option>
          <option>리본</option>
          <option>안경</option>
          <option>왼손</option>
          <option>오른손</option>
          <option>몸통</option>
          <option>아우라</option>
        </select>
      </label>
      <label>테마 이름<input id="form-theme02" required maxlength="20"></label>
      <div class="popup-btns">
        <button type="submit" class="popup-save">저장</button>
        <button type="button" class="popup-cancel" id="popup-cancel">취소</button>
      </div>
    </form>
  </div>
  <script>
    // ... (여기에 기존 js 그대로 - 위 oboe.edit_file 패치 예시 포함)
    // (JS 전체 원하면 바로 내려줄 수 있음. 위 구조는 위치 완벽!)

    // 카테고리 탭 아이콘 교체 및 필터링
    const iconMap = {
      "": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_all.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_all.png"
      },
      "헤어": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_hair.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_hair.png"
      },
      "상하의": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_clothes.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_clothes.png"
      },
      "남옷": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_boy.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_boy.png"
      },
      "여옷": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_girl.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_girl.png"
      },
      "겉옷": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_outer.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_outer.png"
      },
      "신발": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_shoes.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_shoes.png"
      },
      "모자": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_hat.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_hat.png"
      },
      "리본": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_ribbon.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_ribbon.png"
      },
      "안경": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_glasses.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_glasses.png"
      },
      "왼손": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_left.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_left.png"
      },
      "오른손": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_right.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_right.png"
      },
      "몸통": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_body.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_body.png"
      },
      "아우라": {
        ac: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/ac_aura.png",
        de: "https://vifigigmfjtiuoixzdyj.supabase.co/storage/v1/object/public/category-icons/de_aura.png"
      }
    };

    document.addEventListener("DOMContentLoaded", function() {
      const btns = document.querySelectorAll('.cat-btn');
      // 초기 전체만 ac, 나머지는 de
      btns.forEach(b => {
        const cat = b.getAttribute('data-cat');
        const img = b.querySelector('img');
        if (cat === "") {
          b.classList.add('selected');
          if (iconMap[""]) img.src = iconMap[""].ac;
        } else {
          b.classList.remove('selected');
          if (iconMap[cat]) img.src = iconMap[cat].de;
        }
      });
      // 클릭 이벤트
      btns.forEach(btn => {
        btn.addEventListener('click', () => {
          btns.forEach(b => {
            b.classList.remove('selected');
            const cat = b.getAttribute('data-cat');
            const img = b.querySelector('img');
            if (iconMap[cat]) img.src = iconMap[cat].de;
          });
          btn.classList.add('selected');
          const cat = btn.getAttribute('data-cat');
          const img = btn.querySelector('img');
          if (iconMap[cat]) img.src = iconMap[cat].ac;
          // 카드 필터 함수 호출
          filterCategory(cat);
        });
      });
      // 초기 필터링
      filterCategory("");
    });

    // filterCategory 함수는 drawCards와 연결 (카테고리별 필터링)
    function filterCategory(cat) {
      // 이 함수는 drawCards와 연결되어야 하며, cat(카테고리명) 인자를 받아서 해당 카테고리만 필터링해서 보여줍니다.
      // 예시: drawCards({ category: cat });
      // 실제 drawCards 구현에 맞게 연결하세요.
      if (typeof drawCards === "function") {
        drawCards({ category: cat });
      }
    }
  </script>
</body>
</html>